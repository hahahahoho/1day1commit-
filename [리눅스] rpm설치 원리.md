# RPM(RedHat Package Manager)

폐쇄망에서 프로젝트를 진행중이라 yum을 사용할 수 없는 상황입니다. yum을 통해서만 패키지들을 설치하고 관리만 해보았기 때문에, 이런 경우는 엄청나게 삽질을 할 수 밖에 없네요..ㅠㅠ 프로젝트를 진행하기 위해서 rpm으로 필요한 패키지들을 설치해야 하는데, 이를 위해서 rpm이란 무엇인가 더 찾아볼 필요가 생겨서 정리하게 되었습니다.

### RPM이란

##### R**edHat **P**ackage **M**anager의 약자로 **레드햇 계열의 리눅스 배포판에서 사용하는 프로그램(패키지) 설치 관리 도구 입니다. 현재는 RPM Package Manager의 재구적 약자로 사용되어 지고 있습니다. 오픈소스 진영 특유의 유머가 느껴지는 약자로 GNU의 **G**NU is **N**ot **U**nix 와 같은 원리라고 볼 수 있습니다.

### RPM 등장 배경

초기의 리눅스에서는 모든 패키지를 tar와 gzip으로 묶인 소스 파일을 가지고 직접 컴파일 한 후에 수동으로 설치해야 했습니다.  이때 만약 A라는 패키지(프로그램)을 개발하는데에 B라는 패키지가 사용되었다면 B패키지를 먼저 수동으로 설치 후 A패키지를 수동으로 설치해 주어야 했습니다. 만약 하나의 패키지가 아니라 이런식으루 줄줄이 여러 패키지에 **의존하는 경우** 문제는 더욱 더 복잡해 졌습니다.

따라서 패키지 설치에 너무 많은 시간과 노력이 투자 되었기에 RedHat 사에서 리눅스를 더 편하게 사용하고자 패키지 관리 프로그램인 RPM을 만든 것입니다. RPM을 이용하면 Windows의 setup.exe와 비슷하게 패키지를 자동으로 설치할 수 있게 도와줍니다. 

그러나 패키지 사이에 의존하고 있는 패키지까지 자동으로 설치되지는 않습니다.

* 패키지 의존 관리까지 원하는 경우 이후 등장한 yum을 사용합니다.

### **RPM 패키지 구성**

RPM 패키지는 컴파일되어 설치한 **실행파일, 설정파일, 라이브러리** 등을 묶은것입니다.

설치 전후로 스크립트를 사용하여 필요한 작업들이 수행되며, 삭제도 마찬가지로 패키지로 묶인 파일 리스트를 보관하여 관련 파일들을 삭제하게 됩니다. 설정 파일의 경우에는 설정하고 싶은 설정파일이 있을 때 설정파일명.RPMNEW 파일을 생성하고, 패키지를 삭제하려는 경우 설정파일은 .RPMSAVE 확장자로 설정파일이 백업됩니다.

| **패키지 이름**          | **-** | **소스 버전** | **-** | **릴리즈 버전** | **.** | **배포판(OS) 버전** | **.** | **아키텍처** | **.** | **rpm** |
| ------------------------ | ----- | ------------- | ----- | --------------- | ----- | ------------------- | ----- | ------------ | ----- | ------- |
| **mysql-connector-java** | **-** | **5.1.25**    | **-** | **3**           | **.** | **el7**             | **.** | **noarch**   | **.** | **rpm** |

**아키텍처**

- **i386, i486, i586, i686** : 인텔 또는 AMD 계열의 32비트 CPU를 의미합니다.
- **x86_64** : 인텔 또는 AMD 계열의 64비트 CPU를 의미합니다.
- **alpha/sparc/ia64** : 미국 dec사의 알파, 썬 마이크로 시스템즈의 스팍, 인텔의 아이테니엄 프로세서로 CPU 명령어를 줄여 하드웨어 구조를 심플하게 만드는 RISC(Reduced Instruction Set Computer) 설계 방식의 CPU를 의미하나 잘 사용되지는 않습니다.
- **src** : 소스 파일 패키지로 설치 이후 별도로 컴파일 해야 합니다.
- **noarch** : (No Architecture) 모든 CPU에 설치 가능합니다.



### **RPM 명령어 사용**

rpm 명령어 사용 방법을 간단히 설명하자면 다음과 같습니다.

```markdown
rpm [옵션] [rpm 패키지파일 또는 rpm 패키지이름]
```

#### 조회

```markdown
rpm -qa
rpm -qa 패키지이름
rpm -qa | grep 패키지이름
```

#### 설치

```markdown
rpm -Uvh 패키지파일
```

- U 옵션은 패키지를 설치하되 만약 패키지가 이미 설치된 경우 업그레이드로 진행하라는 뜻입니다.
- v 옵션은 패키지 설치시 설치 과정을 출력하라는 뜻입니다.
- h 옵션은 설치 진행률을 # 기호로 채워나가도록 화면에 출력하라는 뜻입니다.

#### 삭제

```
rpm -e 패키지이름
```





#### **설치 옵션**

```
--nodeps

패키지 설치시 현재 설치하는 패키지가 필요로 하는 의존 패키지의 설치 여부를 검사하지 않습니다.

rpm 패키지는 또 다른 패키지의 기능을 사용하기도 하는데 당연히 해당 패키지가 먼저 설치되어 있어야 하지만 해당 옵션을 사용하면 검사를 하지 않습니다.
```

```
--force

설치중 발생하는 에러를 무시하고 강제로 설치를 진행합니다.

--replacepkgs --replacefiles --oldpackage 옵션들을 동시에 사용한것과 같은 효과입니다.
```

```
--oldpackage

새로운 패키지를 지우고 구 버전의 패키지를 설치할 때 사용합니다.
```

```
--replacepkgs

이미 같은 패키지가 설치되어 있으면 재설치 합니다.
```

```
--root <dir>

모든 동작을 <dir> 을 기준으로 최상위 디렉터리로 인식하고 작업합니다.

--root /myDir 를 사용하면 이후 모든 경로에 대해 '/' 는 /myDir을 의미하게 됩니다.
```

```
--test

패키지를 실제로 설치하지 않고 가상으로 설치해본 뒤 오류나 충돌사항이 있는지 점검합니다.
```

```
--noscript

설치 전후로 실행하는 preinstall, postinstall 스크립트를 실행하지 않습니다.
```

```
--excludedocs

문서파일(man page, info page)를 제외하고 설치합니다.
```



